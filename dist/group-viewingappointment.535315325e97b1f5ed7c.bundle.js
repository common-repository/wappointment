(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"5oH9":function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,[{key:"suffix",value:function(){return"wappointment/v1"}}]),t}();e.a=o},A5Wa:function(t,e,n){"use strict";var i=n("Tk7a");i.tz.setDefault(),e.a=i},ALPF:function(t,e,n){"use strict";n.r(e);var i=n("fP5I"),o=n("5oH9"),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o["a"]),a(e,[{key:"endpoints",value:function(){return{get:{method:"post",route:"appointment"},cancel:{method:"patch",route:"appointment"}}}}]),e}(),s=n("KH6Y"),c=n("A5Wa"),u=n("UgAb"),d=n("G5JO"),l=n("G0ds"),p={data:function(){return{bbDef:[{f:"b",r:"strong"},{f:"h2",r:"h2"}]}},methods:{parseBB:function(t){var e=!0,n=!1,i=void 0;try{for(var o,a=this.bbDef[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var r=o.value;t=(t=t.replaceAll("["+r.f+"]","<"+r.r+">")).replaceAll("[/"+r.f+"]","</"+r.r+">")}}catch(t){n=!0,i=t}finally{try{!e&&a.return&&a.return()}finally{if(n)throw i}}return t}}},h=n("KHd+"),f=Object(h.a)(p,void 0,void 0,!1,null,null,null).exports,m={computed:{isReschedulePage:function(){return-1!==this.viewData.indexOf("reschedule-event")},isCancelPage:function(){return-1!==this.viewData.indexOf("cancel-event")},isSaveEventPage:function(){return"add-event-to-calendar"==this.viewData},isViewEventPage:function(){return"view-event"==this.viewData}},methods:{getText:function(t){return this.isCancelPage?this.options.cancel[t]:this.options.reschedule[t]}}},v=Object(h.a)(m,void 0,void 0,!1,null,null,null).exports,g={data:function(){return{ctdString:"",ctdId:!1,ctdInitDate:null,ctdFormat:""}},methods:{initCountDown:function(t,e){this.ctdFormat=e,this.ctdInitDate=new Date,this.ctdInitDate.setTime(1e3*t),this.ctdInitDate.getTime()&&(this.ctdId=setInterval(this.countdownInterval,1e3))},countdownInterval:function(){var t=this.ctdInitDate.getTime()-(new Date).getTime();t<0?(this.ctdString="",clearInterval(this.ctdId)):this.ctdString=this.ctdFormat.replace("[days_left]",Math.floor(t/this.oneDayInMs)).replace("[hours_left]",Math.floor(t%this.oneDayInMs/this.oneHourInMs)).replace("[minutes_left]",Math.floor(t%this.oneHourInMs/this.oneMinInMs)).replace("[seconds_left]",Math.floor(t%this.oneMinInMs/this.oneSecInMs))}},computed:{oneDayInMs:function(){return 24*this.oneHourInMs},oneHourInMs:function(){return 60*this.oneMinInMs},oneMinInMs:function(){return 60*this.oneSecInMs},oneSecInMs:function(){return 1e3}}},w=Object(h.a)(g,void 0,void 0,!1,null,null,null).exports,b=n("Q6gv"),_=n("wUn3"),y=n("76M+"),x={props:["appointmentkey","options","rescheduleData"],components:{BookingForm:function(){return{component:Promise.all([n.e(2),n.e(5),n.e(4),n.e(13)]).then(n.bind(null,"gIVG")),loading:_.a,error:y.a,delay:100,timeout:6e3}}},extends:i.a,methods:{changedStep:function(t){this.$emit("changedStep",t)}}},S=Object(h.a)(x,function(){var t=this.$createElement;return(this._self._c||t)("BookingForm",{attrs:{serviceAction:"rescheduling",appointmentkey:this.appointmentkey,rescheduleData:this.rescheduleData,options:this.options},on:{changedStep:this.changedStep}})},[],!1,null,null,null).exports;var C,D,R={mixins:[u.a,d.a,l.a,v],components:{SaveButtons:b.a,RescheduleForm:S},props:["appointmentkey","viewData","options","serviceAppointment","disabledButtons","currentTz","dataLoaded"],data:function(){return{rescheduledConfirmed:!1,showCancelConfirmation:!1,appointmentCanceled:!1,loading:!1,buttonClicked:!1,showReschedule:!1,appointment:!1,service:!1,staff:!1}},created:function(){this.service=Object.assign({},this.dataLoaded.service),this.appointment=Object.assign({},this.dataLoaded.appointment),this.staff=Object.assign({},this.dataLoaded.staff)},methods:{changedRescheduleStep:function(t){"BookingFormConfirmation"==t&&(this.rescheduledConfirmed=!0)},cancelAppointmentConfirmed:function(){if(this.disabledButtons)return!1;this.loading=!0,this.buttonClicked=!0,this.cancelAppointmentRequest().then(this.appointmentCanceledMet)},cancelAppointmentRequest:(C=regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.serviceAppointment.call("cancel",window.wappointmentExtends.filter("wappointment_cancel_reschedule_data",{appointmentkey:this.appointmentkey},this.dataLoaded));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}),D=function(){var t=C.apply(this,arguments);return new Promise(function(e,n){return function i(o,a){try{var r=t[o](a),s=r.value}catch(t){return void n(t)}if(!r.done)return Promise.resolve(s).then(function(t){i("next",t)},function(t){i("throw",t)});e(s)}("next")})},function(){return D.apply(this,arguments)}),appointmentCanceledMet:function(t){this.loading=!1,this.appointmentCanceled=!0},rescheduleEvent:function(){if(this.disabledButtons)return!1;this.buttonClicked=!0,this.showReschedule=!0},cancelAppointment:function(){this.buttonClicked=!0,this.showCancelConfirmation=!0}},computed:{justRescheduled:function(){return this.showReschedule&&this.rescheduledConfirmed},canStillReschedule:function(){return this.getUnixNow()<this.dataLoaded.appointment.can_reschedule_until},canStillCancel:function(){return this.getUnixNow()<this.dataLoaded.appointment.can_cancel_until},selectedSlot:function(){return this.dataLoaded.appointment.start_at}}},k=Object(h.a)(R,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.isSaveEventPage?n("div",[n("p",[t._v(t._s(t.options.confirmation.savetocal))]),t._v(" "),n("SaveButtons",{attrs:{selectedSlot:t.selectedSlot.start,service:t.dataLoaded.service,appointment:t.appointment,staff:t.staff,currentTz:t.currentTz,physicalSelected:t.physicalSelected,options:t.options,ticket:t.dataLoaded.ticket}})],1):n("div",[t.showReschedule?n("RescheduleForm",{attrs:{appointmentkey:t.appointmentkey,rescheduleData:t.dataLoaded,options:t.options},on:{changedStep:t.changedRescheduleStep}}):t._e(),t._v(" "),t.showCancelConfirmation?n("div",[t.appointmentCanceled?n("p",{staticClass:"h4"},[t._v(t._s(t.getText("confirmed")))]):n("div",[t.loading?n("WLoader"):n("div",[n("p",{staticClass:"h4"},[t._v(t._s(t.getText("confirmation")))]),t._v(" "),n("button",{staticClass:"wbtn wbtn-primary",on:{click:t.cancelAppointmentConfirmed}},[t._v(t._s(t.getText("confirm")))])])],1)]):t._e(),t._v(" "),t.buttonClicked?t._e():n("div",[t.isReschedulePage?[t.canStillReschedule?n("button",{staticClass:"wbtn wbtn-primary",class:"wbtn-"+t.viewData,on:{click:t.rescheduleEvent}},[t._v(t._s(t.getText("button")))]):n("p",{staticClass:"h4"},[t._v(t._s(t.getText("toolate")))])]:t._e(),t._v(" "),t.isCancelPage?[t.canStillCancel?n("button",{staticClass:"wbtn wbtn-primary",class:"wbtn-"+t.viewData,on:{click:t.cancelAppointment}},[t._v(t._s(t.getText("button")))]):n("p",{staticClass:"h4"},[t._v(t._s(t.getText("toolate")))])]:t._e()],2)],1)])},[],!1,null,null,null).exports;var A={mixins:[u.a,d.a,l.a,f,v,w],extends:i.a,components:window.wappointmentExtends.filter("FrontMainViews",{SaveCancelReschedule:k}),props:["appointmentkey","view","options"],data:function(){return{viewName:"appointment",appointment:null,client:null,service:null,staff:null,serviceAppointment:null,loadedAppointment:!1,loading:!1,currentTz:"UTC",date_format:"",date_time_union:"",time_format:"",errorLoading:"",dataLoaded:null,momenttz:c.a,justRescheduled:!1,disabledButtons:!1}},created:function(){this.currentTz=this.tzGuess(),this.serviceAppointment=this.$vueService(new r),this.viewData=this.view,void 0!==this.options.demoData&&(this.appointmentLoaded({data:this.options.demoData.appointmentData}),this.viewData=this.options.demoData.view,this.disabledButtons=!0)},mounted:function(){(this.isReschedulePage||this.isCancelPage||this.isSaveEventPage||this.isViewEventPage)&&void 0===this.options.demoData&&this.refreshAppointment()},methods:{parseBBAndGetText:function(t){var e=this.parseBB(t),n=e.match(/getText\((.*?)\)/);return null!==n?e.replace(/getText\((.*?)\)/,this.getText(n[1])):e},rescheduled:function(){this.justRescheduled=!0},autoRedirect:function(){this.isViewEventPage&&this.zoomSelected&&this.hasMeetingRoom&&this.isStarted&&!this.isOver&&window.location.replace(this.meetingUrl)},refreshAppointment:function(){this.loadedAppointment=!1,this.loadAppointment()},changeLoading:function(t){this.loading=t},convertDateFormat:function(t){return Object(s.a)(t)},loadAppointment:function(){this.loading=!0,this.loadAppointmentRequest().then(this.appointmentLoaded).catch(this.appointmentLoadingError)},loadAppointmentRequest:function(){var t=function(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function i(o,a){try{var r=e[o](a),s=r.value}catch(t){return void n(t)}if(!r.done)return Promise.resolve(s).then(function(t){i("next",t)},function(t){i("throw",t)});t(s)}("next")})}}(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.serviceAppointment.call("get",window.wappointmentExtends.filter("loadAppointmentParams",{appointmentkey:this.appointmentkey},this.getParameterByName));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),appointmentLoadingError:function(t){this.loading=!1,this.errorLoading=t.response.data.message},appointmentLoaded:function(t){this.dataLoaded=t.data,this.appointment=t.data.appointment,this.selection=this.appointment.type,this.client=t.data.client,this.service=t.data.service,this.staff=t.data.staff,this.time_format=this.convertDateFormat(t.data.time_format),this.date_format=this.convertDateFormat(t.data.date_format),this.date_time_union=t.data.date_time_union,this.loadedAppointment=!0,this.loading=!1,this.autoRedirect(),this.initCountDown(this.appointmentStarts,this.options.view.timeleft)}},computed:{isStarted:function(){return this.appointmentStarts<Math.round(Date.now()/1e3)},isOver:function(){return this.appointment.end_at<Math.round(Date.now()/1e3)},hasMeetingRoom:function(){return-1===[void 0,!1,""].indexOf(this.appointment.video_meeting)&&this.appointment.video_meeting},isVideoZoom:function(){var t=parseInt(this.appointment.location_id),e=this.service.locations.find(function(e){return parseInt(e.id)===t});return"zoom"==e.options.type&&"zoom"==e.options.video},meetingUrl:function(){return this.hasMeetingRoom},startDatei18n:function(){return void 0!==this.appointment.converted?this.appointment.converted:this.getMoment(this.appointmentStarts,this.currentTz).format(this.fullDateFormat)},fullDateFormat:function(){return this.date_format+"["+this.date_time_union+"]"+this.time_format},appointmentStarts:function(){return this.appointment.start_at}}},O=(n("RHSf"),Object(h.a)(A,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[0===t.view.indexOf("addonView")?[n(t.view,{tag:"component",attrs:{options:t.options,momenttz:t.momenttz,convertDateFormat:t.convertDateFormat},on:{loading:t.changeLoading}})]:[t.loadedAppointment?n("div",[n("div",{staticClass:"summary-event",class:t.view},[t._l(t.dataLoaded.display,function(e){return n("div",{domProps:{innerHTML:t._s(t.parseBBAndGetText(e))}})}),t._v(" "),n("div",{class:{"old-schedule":t.justRescheduled}},[n("strong",{staticClass:"date-start"},[t._v(t._s(t.startDatei18n))]),t._v(" "),t.justRescheduled?t._e():n("span",[t._v(t._s(t.ctdString))])]),t._v(" "),t.zoomSelected&&t.isViewEventPage&&!t.isOver?n("div",[t.hasMeetingRoom?n("a",{staticClass:"wbtn wbtn-primary wbtn-lg",attrs:{href:t.meetingUrl}},[t._v(t._s(t.options.view.join))]):n("div",{staticClass:"h4"},[t._v(t._s(t.options.view.missing_url))])]):t._e()],2),t._v(" "),n("SaveCancelReschedule",{attrs:{appointmentkey:t.appointmentkey,viewData:t.viewData,options:t.options,serviceAppointment:t.serviceAppointment,disabledButtons:t.disabledButtons,currentTz:t.currentTz,dataLoaded:t.dataLoaded},on:{rescheduled:t.rescheduled}})],1):n("div",[t.loading?n("WLoader"):n("div",[t._v(t._s(t.errorLoading))])],1)]],2)},[],!1,null,null,null));e.default=O.exports},MkfN:function(t,e,n){"use strict";var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(i=(r=s.next()).done)&&(n.push(r.value),!e||n.length!==e);i=!0);}catch(t){o=!0,a=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw a}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};var a,r,s={computed:{debugIsOn:function(){return void 0!==window.apiWappointment.debug&&1==window.apiWappointment.debug}},methods:{pathAssets:function(t){return void 0===t&&(t=""),apiWappointment.resourcesUrl+t},sleep:(a=regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t){return setTimeout(t,e)}));case 1:case"end":return t.stop()}},t,this)}),r=function(){var t=a.apply(this,arguments);return new Promise(function(e,n){return function i(o,a){try{var r=t[o](a),s=r.value}catch(t){return void n(t)}if(!r.done)return Promise.resolve(s).then(function(t){i("next",t)},function(t){i("throw",t)});e(s)}("next")})},function(t){return r.apply(this,arguments)}),cleanObject:function(t){return Object.entries(t).reduce(function(t,e){var n,a,r,s=o(e,2),c=s[0],u=s[1];return void 0===u?t:i({},t,(r=u,(a=c)in(n={})?Object.defineProperty(n,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[a]=r,n))},{})}}},c=n("KHd+"),u=Object(c.a)(s,void 0,void 0,!1,null,null,null);e.a=u.exports},RHSf:function(t,e,n){"use strict";var i=n("zcS7");n.n(i).a},dbTh:function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,"\n.summary-event{\n    margin: 1rem 0;\n}\n.wbtn.wbtn-lg{\n    font-size: 1.4em;\n    margin: .4em 0;\n}\n.old-schedule{\n    text-decoration: line-through;\n}\n",""])},zcS7:function(t,e,n){var i=n("dbTh");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,n("SZ7m").default)("5f3c740e",i,!0,{})}}]);